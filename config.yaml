camera:
  serial: null
  exposure_us: 8000
  gain: 0
  pixel_format: "BayerRG8"

window:
  x: 0
  y: 0
  width: 1400
  height: 900

plc:
  protocol: "ASCII_TCP"
  ip: "192.168.0.100"
  port: 8501
  addr:
    busy: "DM1522"
    done: "DM1523"
    error: "R1002"
    ready: "R1003"
    run: "R1004"
    trigger: "R000"
    ack: "EM7002"
    result_bits_start_word: "EM7901"
  log_raw_response: false
  trigger_poll_interval_ms: 50
  timeouts:
    connect_ms: 3000
    cycle_ms: 5000

models:
  algo: "GLASS"  # INP or GLASS
  inp:
    path: app/models/anomaly.onnx
    provider: "cuda"
    input_size: 448
    inp_threshold: 0.15
    inp_blur_kernel: 5
    inp_blur_sigma: 4.0
    inp_max_ratio: 0.0
    inp_bin_thresh: 0.2
  glass:
    path: app/models/gls_epoch_124_loss_0_1330_271img.pth
    provider: "cuda"
    input_size: 288
    glass_threshold: 0.5
    glass_batch: 8
    glass_blur_kernel: 33
    glass_blur_sigma: 4.0
    glass_norm_eps: 1.0e-8
    glass_bin_thresh: 0.8
  yolo:
    enabled: false
    path: "models/yolo.engine"
    conf_thres: 0.25
    iou_thres: 0.45

io:
  save_images: true
  output_dir: "runs/latest"
  raw_dir: "runs/raw"
  crops_dir: "runs/crops"
  filename_pattern: "{ts}_{model}_{idx:02d}_{cls}.png"
  save_heatmap: false
  save_binary: false
  save_crops: false

layout:
  count: 28
  order: "row_major"
  rows: 4
  cols: 7
  patch_padding: 10
  crop_method: "circle"
  circle_min_radius: 250
  circle_max_radius: 270
  circle_radius_expand: 0
  circle_erode_iter: 0
  circle_dilate_iter: 0
  circle_blur_kernel: 3
  circle_threshold: 50
  circle_use_otsu: false
  circle_invert: false
  ws_scale: 0.4
  ws_dist_ratio: 0.5
  ws_open_ksize: 5
  ws_open_iter: 2
  ws_bg_dilate_iter: 2
  ws_dist_mask_size: 5
  ws_min_area_px: 2000
  ws_max_contour_pts: 800
